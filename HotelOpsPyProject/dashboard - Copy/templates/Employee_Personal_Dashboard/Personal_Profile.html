{% extends "ceodashboard/homebase.html" %}
{% block content %}
{% load static %}

<!-- Page Header -->
{% comment %} <div class="page-header">
    <div class="row">
        <div class="col-sm-12">
            <h3 class="page-title">Profile</h3>
            <ul class="breadcrumb">
                <li class="breadcrumb-item"><a href="admin-dashboard.html">Dashboard</a></li>
                <li class="breadcrumb-item active">Profile</li>
            </ul>
        </div>
    </div>
</div> {% endcomment %}
<!-- /Page Header -->


<div class="employee-dashboard-container">
    <div class="card">
        <div class="card-body">
            <div class="row">
                <div class="col-sm-12">
                    <div class="profile-view">
                        <div class="profile-img-wrap">
                            <div class="profile-img">
                                <a>
                                    <img id="emp-profile-image" src="/static/Images/avatarimg.webp" alt="Profile Image Preview">
                                </a>
                                <a href="{% url "Profile_View" %}"  class="btn btn-sm btn-primary mt-2 rounded-2" id="ViewProfile">View Profile</a>
                            </div>
                        </div>
                        <div class="profile-basic">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="profile-info-left">
                                        <h3 class="user-name m-t-0 mb-0" id="emp-full-name"></h3>
                                        <ul class="personal-info mt-2">
                                            <li>
                                                <div class="title">Designation:</div>
                                                <div class="text" id="emp-designation"></div>
                                            </li>
                                            <li>
                                                <div class="title">Department:</div>
                                                <div class="text" id="emp-department"></div>
                                            </li>
                                            <li>
                                                <div class="title">Reports to:</div>
                                                <div class="text" id="emp-reporting-to"></div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <ul class="personal-info" style="border-right: 2px dashed #D3D3D4;">
                                        <li>
                                            <div class="title">Code:</div>
                                            <div class="text" id="emp-code"></div>
                                        </li>
                                        <li class="d-flex align-items-center">
                                            <div class="title">Status:</div>
                                            <div class="text" id="emp-status"></div>
                                        </li>
                                        <li>
                                            <div class="title">DOJ:</div>
                                            <div class="text" id="emp-doj"></div>
                                        </li>
                                        <li>
                                            <div class="title">Tenure:</div>
                                            <div class="text" id="emp-tenure"></div>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-md-4">
                                    <ul class="personal-info">
                                    <li>
                                        <div class="title">Phone:</div>
                                        <div class="text" id="emp-phone"></div>
                                    </li>
                                    <li>
                                        <div class="title">Email:</div>
                                        <div class="text" id="emp-email"></div>
                                    </li>
                                    <li>
                                        <div class="title">Birthday:</div>
                                        <div class="text" id="emp-birthday"></div>
                                    </li>

                                    <li>
                                        <div class="title">Gender:</div>
                                        <div class="text" id="emp-gender"></div>
                                    </li>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="tab-content">
    <!-- Profile Info Tab -->
    <div id="emp_profile" class="pro-overview tab-pane fade show active">
        <div class="row">
            <div class="col-md-6 d-flex">
                <div class="card profile-box flex-fill">
                    <div class="card-body">
                        <h3 class="card-title">Personal and Work Informations</h3>
                        <ul class="personal-info">
                            <li>
                                <div class="title">Marital status</div>
                                <div class="text" id="Maritalstatus"></div>
                            </li>

                            <li>
                                <div class="title">Level</div>
                                <div class="text" id="Level"></div>
                            </li>
                            <li>
                                <div class="title">Official Email Address</div>
                                <div class="text" id="OfficialEmailAddress"></div>
                            </li>
                            <li>
                                <div class="title">Official Mobile No</div>
                                <div class="text" id="OfficialMobileNo"></div>
                            </li>
                            <li>
                                <div class="title">Company Accommodation</div>
                                <div class="text" id="CompanyAccommodation"></div>
                            </li>
                            <li>
                                <div class="title">Locker</div>
                                <div class="text" id="Locker"></div>
                            </li>

                            <li>
                                <div class="title">LockerType</div>
                                <div class="text" id="LockerType"></div>
                            </li>
                            <li>
                                <div class="title">Locker Number</div>
                                <div class="text" id="LockerNumber"></div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-6 d-flex">
                <div class="card profile-box flex-fill">
                    <div class="card-body">
                        <h3 class="card-title">Emergency Contact</h3>
                        <ul class="personal-info">
                            <li>
                                <div class="title">Name</div>
                                <div class="text" id="EmergencyContactName">John Doe</div>
                            </li>
                            <li>
                                <div class="title">Relationship</div>
                                <div class="text" id="Relationship">Father</div>
                            </li>
                            <li>
                                <div class="title">Phone 1</div>
                                <div class="text" id="Phone1"></div>
                            </li>
                            <li>
                                <div class="title">Phone 2</div>
                                <div class="text" id="Phone2"></div>
                            </li>
                        </ul>
                        {% comment %} <hr> {% endcomment %}
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 d-flex">
                <div class="card profile-box flex-fill">
                    <div class="card-body">
                        <h3 class="card-title">Bank information</h3>
                        <ul class="personal-info">
                            <li>
                                <div class="title">Bank name</div>
                                <div class="text" id="BankName"></div>
                            </li>
                            <li>
                                <div class="title">Branch Name</div>
                                <div class="text" id="BankBranch"></div>
                            </li>
                            <li>
                                <div class="title">Bank account No.</div>
                                <div class="text" id="BankAccountNo"></div>
                            </li>
                            <li>
                                <div class="title">IFSC Code</div>
                                <div class="text" id="IFSCCode"></div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-md-6 d-flex">
                <div class="card profile-box flex-fill">
                    <div class="card-body">
                        <h3 class="card-title">Family Informations</h3>
                        <ul class="personal-info">
                            <li>
                                <div class="title">Mother Name</div>
                                <div class="text" id="MotherName"></div>
                            </li>
                            <li>
                                <div class="title">Date of Birth</div>
                                <div class="text" id="MotherDateofBirth"></div>
                            </li>
                            <li>
                                <div class="title">Age</div>
                                <div class="text" id="MotherAge"></div>
                            </li>
                            <li>
                                <div class="title">Contact No</div>
                                <div class="text" id="MotherContactNo"></div>
                            </li>
                        </ul>
                        <hr>
                        <ul class="personal-info">
                            <li>
                                <div class="title">Father Name</div>
                                <div class="text" id="FatherName"></div>
                            </li>
                            <li>
                                <div class="title">Date of Birth</div>
                                <div class="text" id="FatherDateofBirth"></div>
                            </li>
                            <li>
                                <div class="title">Age</div>
                                <div class="text" id="FatherAge"></div>
                            </li>
                            <li>
                                <div class="title">Contact No</div>
                                <div class="text" id="FatherContactNo"></div>
                            </li>
                        </ul> 
                         <hr>
                        <ul class="personal-info">
                            <li>
                                <div class="title">Spouse Name</div>
                                <div class="text" id="SpouseName"></div>
                            </li>
                            <li>
                                <div class="title">Date of Birth</div>
                                <div class="text" id="SpouseDateofBirth"></div>
                            </li>
                            <li>
                                <div class="title">Age</div>
                                <div class="text" id="SpouseAge"></div>
                            </li>
                            <li>
                                <div class="title">Contact No</div>
                                <div class="text" id="SpouseContactNo"></div>
                            </li>
                        </ul> 
                    </div>
                </div>
            </div>
        </div>
        {% comment %} <div class="row">
            <div class="col-md-6 d-flex">
                <div class="card profile-box flex-fill">
                    <div class="card-body">
                        <h3 class="card-title">Education Informations</h3>
                        <div class="experience-box">
                            <ul class="experience-list">
                                <li>
                                    <div class="experience-user">
                                        <div class="before-circle"></div>
                                    </div>
                                    <div class="experience-content">
                                        <div class="timeline-content">
                                            <a href="#/" class="name">International College of Arts and Science (UG)</a>
                                            <div>Bsc Computer Science</div>
                                            <span class="time">2000 - 2003</span>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="experience-user">
                                        <div class="before-circle"></div>
                                    </div>
                                    <div class="experience-content">
                                        <div class="timeline-content">
                                            <a href="#/" class="name">International College of Arts and Science (PG)</a>
                                            <div>Msc Computer Science</div>
                                            <span class="time">2000 - 2003</span>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 d-flex">
                <div class="card profile-box flex-fill">
                    <div class="card-body">
                        <h3 class="card-title">Experience</h3>
                        <div class="experience-box">
                            <ul class="experience-list">
                                <li>
                                    <div class="experience-user">
                                        <div class="before-circle"></div>
                                    </div>
                                    <div class="experience-content">
                                        <div class="timeline-content">
                                            <a href="#/" class="name">Web Designer at Zen Corporation</a>
                                            <span class="time">Jan 2013 - Present (5 years 2 months)</span>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="experience-user">
                                        <div class="before-circle"></div>
                                    </div>
                                    <div class="experience-content">
                                        <div class="timeline-content">
                                            <a href="#/" class="name">Web Designer at Ron-tech</a>
                                            <span class="time">Jan 2013 - Present (5 years 2 months)</span>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="experience-user">
                                        <div class="before-circle"></div>
                                    </div>
                                    <div class="experience-content">
                                        <div class="timeline-content">
                                            <a href="#/" class="name">Web Designer at Dalt Technology</a>
                                            <span class="time">Jan 2013 - Present (5 years 2 months)</span>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div> {% endcomment %}
    </div>
    <!-- /Profile Info Tab -->
</div>
    <!-- /Assets -->



<script>
    document.addEventListener("DOMContentLoaded", function() {
        fetch("/dashboard/api/Employee-Personal-Data/")
            .then(response => response.json())
            .then(data => {
                const emp = data.Emobj;

                console.log("Information About Object:", emp);

                document.getElementById("emp-full-name").textContent = `${emp.FullName || ''}`;
                document.getElementById("emp-designation").textContent = `${emp.Designation || ''} (${emp.Level || ''})`;
                document.getElementById("emp-department").textContent = emp.Department || '';
                document.getElementById("emp-reporting-to").textContent = emp.ReportingtoDesignation || '';
                document.getElementById("emp-code").textContent = emp.EmployeeCode || '';
                document.getElementById("emp-status").textContent = emp.EmpStatus || '';
                document.getElementById("emp-doj").textContent = formatDate(emp.DateofJoining);
                document.getElementById("emp-tenure").textContent = emp.TenureTillToday || '';
                document.getElementById("emp-phone").textContent = emp.MobileNumber || '';
                document.getElementById("emp-email").textContent = emp.EmailAddress || '';
                document.getElementById("emp-birthday").textContent = formatBirthday(emp.DateofBirth);
                document.getElementById("emp-gender").textContent = emp.Gender || '';

                const profileImg = document.getElementById("emp-profile-image");
                if (emp.ProfileImageFileName) {
                    // profileImg.src = `/Employee_Personal_Dashboard/${emp.EmpID}`;  // or construct URL dynamically
                    profileImg.src = `/HumanResources/Humanview_file/?ID=${emp.EmpID}&model=EmployeePersonalDetails`;  // or construct URL dynamically
                }


                // Bank Informations
                const Bank = data.Bank_Details;
                // console.log("Bank Details::", Bank)
                document.getElementById("BankName").textContent = Bank.NameofBank || '';
                document.getElementById("BankBranch").textContent = Bank.BankBranch || '';
                document.getElementById("BankAccountNo").textContent = Bank.BankAccountNumber || '';
                document.getElementById("IFSCCode").textContent = Bank.IFSCCode || '';


                // Work details Informations
                const Work_Details = data.Work_Details;
                // console.log("Work Details::", Work_Details)
                document.getElementById("Level").textContent = Work_Details.Level || '';
                document.getElementById("OfficialEmailAddress").textContent = Work_Details.OfficialEmailAddress || '';
                document.getElementById("OfficialMobileNo").textContent = Work_Details.OfficialMobileNo || '';
                document.getElementById("CompanyAccommodation").textContent = Work_Details.CompanyAccommodation || '';
                document.getElementById("Locker").textContent = Work_Details.Locker || '';
                document.getElementById("LockerType").textContent = Work_Details.LockerType || '';
                document.getElementById("LockerNumber").textContent = Work_Details.LockerNumber || '';


                // Personal details Informations
                const Personal_Details = data.Personal_Details;
                // console.log("Work Details::", Work_Details)
                document.getElementById("Maritalstatus").textContent = Personal_Details.MaritalStatus || '';


                // Emergency details informations
                const Em_info = data.Emergency_informations;
                // console.log("Em_info Details::", Em_info)
                const FullName = `${Em_info.FirstName} ${Em_info.MiddleName} ${Em_info.LastName}`
                document.getElementById("EmergencyContactName").textContent = FullName || '';
                document.getElementById("Relationship").textContent = Em_info.Relation || '';
                document.getElementById("Phone1").textContent = Em_info.EmergencyContactNumber_1 || '';
                document.getElementById("Phone2").textContent = Em_info.EmergencyContactNumber_2 || '';


                // Family details informations
                const family_obj  = data.family_obj ;
                console.log("family_obj Details::", family_obj)
                document.getElementById("MotherName").textContent = family_obj.MotherName || '';
                document.getElementById("MotherDateofBirth").textContent = family_obj.MotherDateofBirth || '';
                document.getElementById("MotherAge").textContent = family_obj.MotherAge || '';
                document.getElementById("MotherContactNo").textContent = family_obj.MotherContactNo || '';

                document.getElementById("FatherName").textContent = family_obj.FatherName || '';
                document.getElementById("FatherContactNo").textContent = family_obj.FatherContactNo || '';
                document.getElementById("FatherAge").textContent = family_obj.FatherAge || '';
                document.getElementById("FatherContactNo").textContent = family_obj.FatherContactNo || '';

                document.getElementById("SpouseName").textContent = family_obj.SpouseName || '';
                document.getElementById("SpouseDateofBirth").textContent = family_obj.SpouseDateofBirth || '';
                document.getElementById("SpouseAge").textContent = family_obj.SpouseAge || '';
                document.getElementById("SpouseContactNo").textContent = family_obj.SpouseContactNo || '';
            })
            .catch(error => {
                console.error("Failed to load employee data:", error);
            });

            function formatDate(dateStr) {
                if (!dateStr) return "";
                const date = new Date(dateStr);
                return date.toLocaleDateString('en-IN', { year: 'numeric', month: 'long', day: 'numeric' });
            }

            function formatBirthday(dateStr) {
                if (!dateStr) return "";
                const date = new Date(dateStr);
                return date.toLocaleDateString('en-IN', { month: 'long', day: 'numeric' });
            }
    });
</script>


{% endblock content %}
