
{% extends "HR/EmployeeDashboard/EditEmployee.html" %}
 {% load static %} 
{% block content %}


<style>
    .strike{
        color: red;
    }
    .hide{

        display:none;
    }
    label{
        padding-top: 14px;
    }


    .card {
        border-radius: 5px;
        border: 1px solid #0000004f;
    }
    
    .card-header{
        margin-bottom: -20px !important;
    }

    .submit-button-wrapper{
        text-align: right;
    }
</style>

<form id="workInfoForm" method="post" enctype="multipart/form-data">
<div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
            <span class=" text-uppercase fw-bold"> Work Information </span> 
            <button type="button" id="editButton" class="btn btn-primary btn-sm float-right" value="Edit">Edit</button>
        </div>

        <div class="main">
            <div class="m-1">
                <div class="row m-1">
                    <div class="col-md-5">
                        <label for="Designation">Designation</label>
                        <select id="Designation" name="Designation" class="form-control" required>
                            <option value="">Select Position</option>
                        

                            {% for Designation in MergedDesignations %}
                            <option value="{{ Designation.designations }}" 
                                    {% if Workobj.Designation == Designation.designations %}selected{% endif %}
                                    data-level="{{ Designation.Lavel }}"

                                    {% if Designation.OnRollDivisionMaster %}
                                        data-division="{{ Designation.OnRollDivisionMaster.DivisionName }}"
                                    {% elif Designation.CorporateDivisionMaster %}
                                        data-division="{{ Designation.CorporateDivisionMaster.DivisionName }}"
                                    {% endif %}
                        
                                    {% if Designation.OnRollDepartmentMaster %}
                                        data-department="{{ Designation.OnRollDepartmentMaster.DepartmentName }}"
                                    {% elif Designation.CorporateDepartmentMaster %}
                                        data-department="{{ Designation.CorporateDepartmentMaster.DepartmentName }}"
                                    {% endif %}>
                                {{ Designation.designations }}  
                                
                                {% if Designation.OnRollDepartmentMaster %}
                                    ({{ Designation.OnRollDepartmentMaster.DepartmentName }}) 
                                {% elif Designation.CorporateDepartmentMaster %}
                                    ({{ Designation.CorporateDepartmentMaster.DepartmentName }}) - Nile
                                {% endif %}
                            </option>
                    
                            {% endfor %}
                        </select>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Division <span class="strike">*</span></label>
                            <input id="Division" name="Division" type="text" class="form-control" readonly>
                        </div>
                    </div>
                    
                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Department <span class="strike">*</span></label>
                            <input id="Department" name="Department" type="text" class="form-control" readonly>
                        </div>
                    </div>
                    
                    <div class="col-md-1">
                        <div class="form-group">
                            <label>Level <span class="strike">*</span></label>
                            <input id="Level" name="Level" type="text" class="form-control" readonly>
                        </div>
                    </div>
                    
                    <div class="col-md-5">
                        <div class="form-group">
                            <label>Direct Reporting <span class="strike">*</span></label>
                            <select id="ReportingToDesignation" name="ReportingToDesignation" class="form-control" required>
                                <option value="">Select Position</option>
                            

                                {% for Designation in MergedReportingtoDesignation %}
                                <option value="{{ Designation.designations }}" 
                                        {% if Workobj.ReportingtoDesignation == Designation.designations %}selected{% endif %}
                                        data-ReportingToDesignationLevel="{{ Designation.Lavel }}"

                                        {% if Designation.OnRollDivisionMaster %}
                                            data-ReportingtoDivision="{{ Designation.OnRollDivisionMaster.DivisionName }}"
                                        {% elif Designation.CorporateDivisionMaster %}
                                            data-ReportingtoDivision="{{ Designation.CorporateDivisionMaster.DivisionName }}"
                                        {% endif %}

                                        {% if Designation.OnRollDepartmentMaster %}
                                            data-ReportingToDesignationLeveldepartment="{{ Designation.OnRollDepartmentMaster.DepartmentName }}"
                                        {% elif Designation.CorporateDepartmentMaster %}
                                            data-ReportingToDesignationLeveldepartment="{{ Designation.CorporateDepartmentMaster.DepartmentName }}"
                                        {% endif %}>
                                    {{ Designation.designations }}  
                                    
                                    {% if Designation.OnRollDepartmentMaster %}
                                        ({{ Designation.OnRollDepartmentMaster.DepartmentName }}) 
                                    {% elif Designation.CorporateDepartmentMaster %}
                                        ({{ Designation.CorporateDepartmentMaster.DepartmentName }}) - Nile
                                    {% endif %}
                                </option>
                        
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Division <span class="strike">*</span></label>
                            <input id="ReportingtoDivision" name="ReportingtoDivision" type="text" class="form-control" readonly required>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Department <span class="strike">*</span></label>
                            <input id="ReportingToDesignationDepartment" name="ReportingToDesignationDepartment" type="text" class="form-control" readonly>
                        </div>
                    </div>
                    <div class="col-md-1">
                        <div class="form-group">
                            <label>Level <span class="strike">*</span></label>
                            <input id="ReportingToDesignationLevel" name="ReportingToDesignationLevel" type="text" class="form-control" readonly>
                        </div>
                    </div>
                    <div class="col-md-5">
                        <label for="DottedLine">Dotted Line Reporting Desigination</span></strong> </label>
                        <select id="DottedLine" name="DottedLine"  class="form-control" required>
                            <option value="">Select Dotted Line</option>
                            {% for Designation in MergedDottedLineDesignations %}
                                <option value="{{ Designation.designations }}" 
                                    {% if Workobj.DottedLine == Designation.designations %}selected{% endif %}>
                                    {{ Designation.designations }}
                                    {% if Designation.OnRollDepartmentMaster %}
                                        ({{ Designation.OnRollDepartmentMaster.DepartmentName }})
                                    {% elif Designation.CorporateDepartmentMaster %}
                                        ({{ Designation.CorporateDepartmentMaster.DepartmentName }}) - Nile
                                    {% endif %}
                                </option>
                            {% endfor %}
                        </select>
                    </div> 
                    <div class="col-md-12 mt-3 mb-2">
                        <p class="text-uppercase text-success">Dotted Line Reporting Desigination - <strong><span>If Dotted Line Reporting Desigination is not present then Reporting to Designation will be  dotted line.</span></strong></p>
                    </div> 

                    <script>
                        function updateDesignationDetails() {
                            var selectElement = document.getElementById('Designation');
                            var selectedOption = selectElement.options[selectElement.selectedIndex];
                            var department = selectedOption.getAttribute('data-department');
                            var division = selectedOption.getAttribute('data-division');
                            var level = selectedOption.getAttribute('data-level');
                            
                            document.getElementById('Department').value = department || '';
                            document.getElementById('Division').value = division || '';
                            document.getElementById('Level').value = level || '';
                        }
                    
                        function ReportingupdateDesignationDetails() {
                            var selectElement = document.getElementById('ReportingToDesignation');
                            var selectedOption = selectElement.options[selectElement.selectedIndex];
                            var department = selectedOption.getAttribute('data-ReportingToDesignationLeveldepartment');
                            var division = selectedOption.getAttribute('data-ReportingtoDivision');
                            var level = selectedOption.getAttribute('data-ReportingToDesignationLevel');
                            
                            document.getElementById('ReportingToDesignationDepartment').value = department || '';
                            document.getElementById('ReportingtoDivision').value = division || '';
                            document.getElementById('ReportingToDesignationLevel').value = level || '';
                        }
                    
                    
                        window.onload = function() {
                            updateDesignationDetails();
                            ReportingupdateDesignationDetails();
                        };
                    
                        document.getElementById('Designation').addEventListener('change', updateDesignationDetails);
                        document.getElementById('ReportingToDesignation').addEventListener('change', ReportingupdateDesignationDetails);
                    </script>
                </div> 
            </div> 
        </div> 
</div> 
<div class="card">
    <div class="main">
        <div class="m-1 mb-4">
            <div class="row m-1">
                <div class="col-md-4">
                    <div class="form-group">
                        <label>Official Email Address </label>
                        <input id="OfficialEmailAddress" name="OfficialEmailAddress" value="{{Workobj.OfficialEmailAddress }}" type="email" class="form-control">
                        <span id="emailError" style="color:red;"></span>

                        <script>
                            document.getElementById('OfficialEmailAddress').addEventListener('input', function () {
                                const email = this.value;
                                const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                                const emailError = document.getElementById('emailError');

                                if (!regex.test(email)) {
                                    emailError.textContent = "Invalid email format";
                                } else {
                                    emailError.textContent = "";
                                }
                            });
                        </script>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label>Official Mobile No </label>
                        <input id="OfficialMobileNo" name="OfficialMobileNo" type="text" value="{{Workobj.OfficialMobileNo }}" class="form-control">
                        <span id="mobileError" style="color:red;"></span>

                        <script>
                            document.getElementById('OfficialMobileNo').addEventListener('input', function () {
                                const mobile = this.value;
                                // For Indian mobile numbers (10 digits starting with 7, 8, or 9)
                                const regex = /^[6-9]\d{9}$/;
                                const mobileError = document.getElementById('mobileError');

                                if (!regex.test(mobile)) {
                                    mobileError.textContent = "Invalid mobile number";
                                } else {
                                    mobileError.textContent = "";
                                }
                            });
                        </script>    
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group">
                        <label>Date of Joining <span class="strike">*</span></label>
                        <input id="DateOfJoining" name="DateOfJoining" type="date" value="{% if Workobj %}{{Workobj.DateofJoining|date:'Y-m-d'}}{% else %}{% now 'Y-m-d' %}{% endif %}" class="form-control" required>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="form-group">
                        <label>Employment Type  <span class="strike">*</span></label>
                        <select id="EmploymentType"  name="EmploymentType" name="OnRoll" class="form-control" required>
                            <option value="On Roll" {% if Workobj.EmploymentType == "On Roll"  %}selected{% endif %} >On Roll</option>                                    </select>
                    </div>
                </div>
            </div>
                
            <div class="row m-1">
                <div class="col-md-2">
                    <div class="form-group">
                        <label>Accommodation<span class="strike">*</span></label>
                        <select id="CompanyAccommodation" name="CompanyAccommodation" class="form-control" required>
                            <option  value="Yes" {% if Workobj.CompanyAccommodation  == "Yes" %}selected{% endif %} > Yes</option>
                            <option  value="No"  {% if Workobj.CompanyAccommodation  == "No" %}selected{% endif %} >No</option>
                        </select>
                    </div>
                </div>
                <div id="AccommodationFlatNumber" class="col-md-2">
                    <div class="form-group">
                        <label>Flat Number</label>
                        <input  name="AccommodationFlatNumber" type="text" value = "{{Workobj.AccommodationFlatNumber}}" class="form-control" required>
                    </div>
                </div>
                <div class="col-md-1">
                    <div class="form-group">
                        <label>Locker <span class="strike">*</span></label>
                        <select id="Locker" name="Locker" class="form-control" required>
                            <option  value="Yes"    {% if Workobj.Locker  == "Yes" %}selected{% endif %}  >Yes</option>
                            <option  value="No"     {% if Workobj.Locker  == "No" %}selected{%  endif %}>No</option>
                        </select>
                    </div>
                </div>
                <div id="LockerType" class="col-md-2 d-none">
                    <div class="form-group">
                        <label>Locker Type <span class="strike">*</span></label>
                    
                        <select name="LockerType" id="" class="form-control">
                            <option value="">Select</option>
                            <option value="Shared" {% if Workobj.LockerType  == "Shared" %}selected{% endif %} >Shared</option>
                            <option value="Individual" {% if Workobj.LockerType  == "Individual" %}selected{% endif %}  >Individual</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group">
                        <label>Week Off Day </label>
                        <select id="WeekOffDay" name="WeekOffDay" class="form-control"  >
                            <option value="">Select Day</option>
                            <option value="Monday" {% if Workobj.WeekOffDay == "Monday"  %}selected{% endif %}>Monday</option>
                            <option value="Tuesday" {% if Workobj.WeekOffDay == "Tuesday"  %}selected{% endif %}>Tuesday</option>
                            <option value="Wednesday" {% if Workobj.WeekOffDay == "Wednesday"  %}selected{% endif %}>Wednesday</option>
                            <option value="Thursday" {% if Workobj.WeekOffDay == "Thursday"  %}selected{% endif %}>Thursday</option>
                            <option value="Friday" {% if Workobj.WeekOffDay == "Friday"  %}selected{% endif %}>Friday</option>
                            <option value="Saturday" {% if Workobj.WeekOffDay == "Saturday"  %}selected{% endif %}>Saturday</option>
                            <option value="Sunday" {% if Workobj.WeekOffDay == "Sunday"  %}selected{% endif %}>Sunday</option>
                        </select>
                    </div>
                </div> 

                <div id="LockerNumber" class="col-md-2 d-none">
                    <div class="form-group">
                        <label>Locker Number <span class="strike">*</span></label>
                        <input  name="LockerNumber" type="text" value = "{{Workobj.LockerNumber}}" class="form-control">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">Sub Work Information</div>

    <div class="card-body">  
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Designation</th>
                    <th>Division</th>
                    <th>Department</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="departmentTableBody"></tbody>
        </table>

        <button id="addRowBtn" class="btn btn-sm btn-primary">Add Row</button>
    </div>

    <div class="submit-button-wrapper m-3">
        <button type="submit" id="saveButton" class="btn btn-primary Successpopup" style="display:none;">Save</button>
    </div>
    {% csrf_token %}
</div>

</form>

<script>
    var MergedDesignations = {{ merged_designations_json|safe }};
    console.log("MergedDesignations::", MergedDesignations)
    var subrecords = {{ subrecordslist_json|safe }}; // Assuming this contains the subrecords data as JSON
    var currentRowId = 0; // To generate unique IDs for each row
    let idList = []; // Array to track IDs of existing records
    let removedRows = []; // Array to track removed rows
    
    // Function to add a new row dynamically
    document.getElementById('addRowBtn').addEventListener('click', function () {
        const tableBody = document.getElementById('departmentTableBody');
        currentRowId++; // Increment row ID for uniqueness
    
        // Creating new row
        const newRow = document.createElement('tr');
        newRow.setAttribute('id', `row-${currentRowId}`);
    
        // Create Designation select field
        const designationSelect = document.createElement('select');
        designationSelect.name = "Designation[]";
        designationSelect.classList.add('form-control', 'designation-select');
        designationSelect.required = true;
        const defaultOption = document.createElement('option');
        defaultOption.value = "";
        defaultOption.textContent = "Select Position";
        designationSelect.appendChild(defaultOption);
    
        MergedDesignations.forEach(function (Designation) {
            const option = document.createElement('option');
            option.value = Designation.designations;
            option.setAttribute('data-department', Designation.DepartmentName || '');
            option.setAttribute('data-division', Designation.DivisionName || '');
            // console.log("Divisions Name::", Designation.DivisionName)
            option.textContent = `${Designation.designations} ${Designation.DepartmentName ? `(${Designation.DepartmentName})` : ''}`;
            designationSelect.appendChild(option);
        });
    
        // Create Division input field
        const DivisionInput = document.createElement('input');
        DivisionInput.name = "Division[]";
        DivisionInput.type = "text";
        DivisionInput.classList.add('form-control', 'division-input');
        DivisionInput.readOnly = true;
    
        // Create Department input field
        const departmentInput = document.createElement('input');
        departmentInput.name = "Department[]";
        departmentInput.type = "text";
        departmentInput.classList.add('form-control', 'department-input');
        departmentInput.readOnly = true;
    

        const IdInput = document.createElement('input');
        IdInput.name = "ID[]";
        IdInput.type = "hidden";
        IdInput.value = "0";
        
        const IsDeleteInput = document.createElement('input');
        IsDeleteInput.name = "IsDelete[]";
        IsDeleteInput.type = "hidden";
        IsDeleteInput.value = "0";
        

        // Create Remove button
        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.id = 'removeBtn';
        removeBtn.classList.add('btn', 'btn-danger', 'removeRow');
        removeBtn.textContent = 'Remove';
        removeBtn.setAttribute('data-row-id', currentRowId);
    
        // Append all elements to the row
        const tdDesignation = document.createElement('td');
        tdDesignation.appendChild(designationSelect);
        tdDesignation.appendChild(IdInput);
        tdDesignation.appendChild(IsDeleteInput);
    
        // Department td
        const tdDepartment = document.createElement('td');
        tdDepartment.appendChild(departmentInput);
        
        // Division td
        const tdDivision = document.createElement('td');
        tdDivision.appendChild(DivisionInput);
    
        const tdActions = document.createElement('td');
        tdActions.appendChild(removeBtn);
    
        newRow.appendChild(tdDesignation);
        newRow.appendChild(tdDivision);
        newRow.appendChild(tdDepartment);
        newRow.appendChild(tdActions);
    
        // Append the new row to the table
        tableBody.appendChild(newRow);
    
        // Add an empty entry in the idList for this new row (since no record ID exists yet)
        idList.push(null); // No ID for new row
        // updateHiddenFields();
       // displayIdList();  // Update the list display in console
        removeRow();
    });
    
    // Function to dynamically update Department based on selected Designation
    document.addEventListener('change', function (e) {
        if (e.target.classList.contains('designation-select')) {
            const selectElement = e.target;
            const selectedOption = selectElement.options[selectElement.selectedIndex];
            const department = selectedOption.getAttribute('data-department');
            const division = selectedOption.getAttribute('data-division');
            const row = selectElement.closest('tr');
            const departmentInput = row.querySelector('.department-input');
            const divisionInput = row.querySelector('.division-input');
            departmentInput.value = department || '';
            divisionInput.value = division || '';
            
        }
    });
    
    // Function to remove a row
    /* document.addEventListener('click', function (e) {
        if (e.target.classList.contains('removeRow')) {
            debugger;
            alert('Hello')
            const rowId = e.target.getAttribute('data-row-id');
            $(this).parent().parent().find("input[name*='IsDelete']").val(1)
            $(this).parent().parent().addClass('hide')
            //e.target.closest('tr').remove();
            //removedRows.push(rowId); // Track removed row
            //updateHiddenFields();
            //displayIdList();  // Update the list display in console
        }
    });
    */
    var removeRow= function (){
            $("#departmentTableBody .removeRow").on('click',function(){

                $(this).parent().parent().find("input[name*='IsDelete']").val(1)
                $(this).parent().parent().addClass('hide')
            })

    }
    // function updateHiddenFields() {
    //     // Update hidden fields with the actual array (not JSON string)
    //     document.getElementById('idListField').value = idList.join(',');  // Concatenate IDs into a single string for submission
    //     document.getElementById('removedRowsField').value = removedRows.join(',');  // Same for removedRows
    // }

    // Function to display the ID List in the console
    // function displayIdList() {
    //     console.log(idList); // Log the ID list in console in the desired format
    // }

    // Populate the table with existing records (subrecords)
    subrecords.forEach(function (record) {
        const tableBody = document.getElementById('departmentTableBody');
        currentRowId++; // Increment row ID for uniqueness
    
        const newRow = document.createElement('tr');
        newRow.setAttribute('id', `row-${currentRowId}`);
    
        // Create Designation select field
        const designationSelect = document.createElement('select');
        designationSelect.name = "Designation[]";
        designationSelect.classList.add('form-control', 'designation-select');
        designationSelect.required = true;
        const defaultOption = document.createElement('option');
        defaultOption.value = "";
        defaultOption.textContent = "Select Position";
        designationSelect.appendChild(defaultOption);
    
        MergedDesignations.forEach(function (Designation) {
            const option = document.createElement('option');
            option.value = Designation.designations;
            option.setAttribute('data-department', Designation.DepartmentName || '');
            option.setAttribute('data-division', Designation.DivisionName || '');
            option.textContent = `${Designation.designations} ${Designation.DepartmentName ? `(${Designation.DepartmentName})` : ''}`;
            if (record.designations === Designation.designations) {
                option.selected = true;
            }
            designationSelect.appendChild(option);
        });
        

        // Create Division input field
        const DivisionInput = document.createElement('input');
        DivisionInput.name = "Division[]";
        DivisionInput.type = "text";
        DivisionInput.classList.add('form-control', 'division-input');
        DivisionInput.value = record.DivisionName;
        // print("")
        DivisionInput.readOnly = true;

        // Create Department input field
        const departmentInput = document.createElement('input');
        departmentInput.name = "Department[]";
        departmentInput.type = "text";
        departmentInput.classList.add('form-control', 'department-input');
        departmentInput.value = record.DepartmentName;
        departmentInput.readOnly = true;
        
        const IdInput = document.createElement('input');
        IdInput.name = "ID[]";
        IdInput.type = "hidden";
        IdInput.value = record.id;
        
        const IsDeleteInput = document.createElement('input');
        IsDeleteInput.name = "IsDelete[]";
        IsDeleteInput.type = "hidden";
        IsDeleteInput.value = "0";

        // Create Remove button
        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.id = 'removeBtn';
        removeBtn.classList.add('btn', 'btn-danger', 'removeRow');
        removeBtn.textContent = 'Remove';
        removeBtn.setAttribute('data-row-id', currentRowId);
    
        // Append all elements to the row
        const tdDesignation = document.createElement('td');
        tdDesignation.appendChild(designationSelect);
        tdDesignation.appendChild(IsDeleteInput);
        tdDesignation.appendChild(IdInput);
    
        const tdDepartment = document.createElement('td');
        tdDepartment.appendChild(departmentInput);
    
        const tdDivision = document.createElement('td');
        tdDivision.appendChild(DivisionInput);
    
        const tdActions = document.createElement('td');
        tdActions.appendChild(removeBtn);
    
        newRow.appendChild(tdDesignation);
        newRow.appendChild(tdDivision);
        newRow.appendChild(tdDepartment);
        newRow.appendChild(tdActions);
    
        // Append the new row to the table
        tableBody.appendChild(newRow);
    
        // Add the existing record ID to the idList
        idList.push(record.id); // Ensure the ID of the existing record is added
        // updateHiddenFields();
       // displayIdList();  // Update the list display in console
        removeRow();
    });
</script>


<!-- Add more -->


<script src="{% static 'js/plugins/sweetalert/sweetalert.min.js' %}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const editButton = document.getElementById('editButton');
        const saveButton = document.getElementById('saveButton');
        const addRowBtn = document.getElementById('addRowBtn');
        const removeBtns = document.querySelectorAll('.removeRow'); // Select all buttons with the 'removeRow' class

        const allInputs = document.querySelectorAll('#workInfoForm input, #workInfoForm select, #workInfoForm textarea');
        // const excludedInputs = document.querySelectorAll('#Department, #Level, #ReportingToDesignationDepartment, #ReportingToDesignationLevel'); // Replace with actual IDs or classes
        const excludedInputs = document.querySelectorAll('[name="Department[]"] [name="Division[]"], #Division, #Department, #Level, #ReportingtoDivision, #ReportingToDesignationDepartment, #ReportingToDesignationLevel');
    
        const excludedInputsArray = Array.from(excludedInputs);

        // Initially set inputs to readonly/disabled except excluded ones
        allInputs.forEach(input => {
            if (!excludedInputsArray.includes(input)) {
                input.setAttribute('readonly', 'readonly');
                input.setAttribute('disabled', 'disabled');
            }
        });

        // Initially hide buttons
        saveButton.style.display = 'none';
        addRowBtn.style.display = 'none';
        removeBtns.forEach(button => {
            button.style.display = 'none';
        });

        // Function to toggle edit mode
        function toggleEditMode() {
            if (editButton.textContent === 'Edit') {
                editButton.textContent = 'Cancel';
                saveButton.style.display = 'inline-block';
                addRowBtn.style.display = 'inline-block';

                // Show all remove buttons
                removeBtns.forEach(button => {
                    button.style.display = 'inline-block';
                });

                // Enable all inputs except excluded ones
                allInputs.forEach(input => {
                    if (!excludedInputsArray.includes(input)) {
                        input.removeAttribute('readonly');
                        input.removeAttribute('disabled');
                    }
                });
            } else {
                editButton.textContent = 'Edit';
                saveButton.style.display = 'none';
                addRowBtn.style.display = 'none';

                // Hide all remove buttons
                /*
                removeBtns.forEach(button => {
                    button.style.display = 'none';
                })
                    */

                // Set inputs back to readonly/disabled except excluded ones
                allInputs.forEach(input => {
                    if (!excludedInputsArray.includes(input)) {
                        input.setAttribute('readonly', 'readonly');
                        input.setAttribute('disabled', 'disabled');
                    }
                });
            }
        }

        // Attach event listener to Edit button
        editButton.addEventListener('click', toggleEditMode);

        // Attach click event to dynamically handle the removeRow buttons
        
    });
</script>

<script>
    $(document).ready(function() {
        function updateLockerFields() {
            var selectedValue = $('#Locker').val();
            
            if (selectedValue === 'Yes') {
                $('#LockerType').removeClass('d-none');
                $('#LockerNumber').removeClass('d-none');
            } else if (selectedValue === 'No') {
                $('#LockerType').addClass('d-none');
                $('#LockerNumber').addClass('d-none');
            }
        }

      
        updateLockerFields();

      
        $('#Locker').change(updateLockerFields);
    });
</script>

<script>
    $(document).ready(function() {
        function updateEmploymentType() {
            var selectedValue = $('#EmploymentType').val();
            
            if (selectedValue === 'Contract') {
                $('#ContractStartDate').removeClass('d-none');
                $('#ContractEndDate').removeClass('d-none');
            } else {
                $('#ContractStartDate').addClass('d-none');
                $('#ContractEndDate').addClass('d-none');
            }
        }
        
     
        updateEmploymentType();
        
       
        $('#EmploymentType').change(updateEmploymentType);
    });
</script>

<script>
    $(document).ready(function () {
        const urlParams = new URLSearchParams(window.location.search);
        const success = urlParams.get('Success');
        
        if (success === 'True') {
            showSuccess();
            removeSuccessParam();
        }
        if (success === 'Deleted') {
            showDelete();
            removeSuccessParam();
        }
        if (success === 'Uploaded') {
            showUploaded();
            removeSuccessParam();
        }

        function removeSuccessParam() {
            urlParams.delete('Success'); 
            const newUrl = window.location.pathname + '?' + urlParams.toString();
            window.history.replaceState(null, '', newUrl);
        }
    });
</script>
{% endblock content %}