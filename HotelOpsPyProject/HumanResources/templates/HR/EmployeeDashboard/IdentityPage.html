{% extends "HR/EmployeeDashboard/EditEmployee.html" %}
 {% load static %} 
{% block content %}
<link href="{% static 'css/plugins/sweetalert/sweetalert.css' %}" rel="stylesheet">

<style>
    
    #ProfileImagePreview {
        border-radius: 50%;
        border: 2px solid #ddd;     
        margin-top: 10px;
        max-width: 150px; 
        height: 150px;    
        object-fit: cover; 
    }
    .strike{
        color: red;
    }

    label{
        padding-top: 14px;
    }

    .card {
        border-radius: 5px;
        border: 1px solid #0000004f;
    }

    .card-header{
        margin-bottom: -20px;
    }
</style>

<div class="modal fade modalPr" id="fileModal" tabindex="-1" role="dialog" aria-labelledby="fileModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="fileModalLabel">File Preview</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <iframe id="filePreview" style="width: 100%; height: 500px; border: none;" onerror="this.style.display='none'; document.getElementById('filePreviewFallback').style.display='block';"></iframe>
                <div id="filePreviewFallback" style="display:none;">
                    <p>Your browser does not support inline previews. <a id="downloadLink" href="#" download>Click here to download the file.</a></p>
                </div>
            </div>
            <div class="modal-footer">
                <a id="downloadLink" class="btn btn-primary" href="#" download>Download</a>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>



<div class="card pb-3">
    <div class="card-header d-flex justify-content-between align-items-center">
       <span class=" text-uppercase fw-bold"> Identity Information </span>
        <button id="editButton" class="btn btn-primary btn-sm float-right">Edit</button>
    </div>

    <form id="IdentityInfoForm" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="main">
                <div class="row m-1">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>Aadhaar Number <span class="strike">*</span></label>
                        <input type="text" name="AadhaarNumber" id="" class="form-control"  value = "{{IdentityInfo.AadhaarNumber}}" required>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>PAN No</label>
                            <input type="hidden" name="Pre_Identity_ID" value="{{IdentityInfo.id}}">
                            <input type="text" name="PANNo" id="" class="form-control"  value = "{{IdentityInfo.PANNo}}">
                        </div>
                    </div>
                
                    
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>Driving Licence No</label>
                        <input type="text" name="DrivingLicenceNo" id="" class="form-control" value = "{{IdentityInfo.DrivingLicenceNo}}" >
                        </div>
                    </div>
                </div>
                <div class="row m-1">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>Upload Aadhaar <span class="strike">*</span></label>
                        <input type="file" name="Aadhaarattachment" id="" class="form-control mb-3"  {% if  IdentityInfo.AadhaarFileName %}{% else %} required{% endif %}>
                        {% if IdentityInfo.AadhaarFileName %}
                            <span class="mt-4">Previous Document</span>
                            <a  href="javascript:void(0)" data-href="{% url 'Humanview_file' %}?ID={{ IdentityInfo.id }}&model=EmployeeIdentityInformationDetails_Aadhaar" 
                            class="btn btn-primary btn-sm ml-2"
                            onclick="showEduDetails(this)"
                            >
                            <span class="fa fa-eye"></span>
                            </a>
                        {% else%}
                        {% endif %}
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>Upload PAN</label>
                            <input type="file" name="PANattachment" id="" class="form-control  mb-3">
                                    
                                    {% if IdentityInfo.PanFileName %}
                                    Previous Document
                                    <a  href="javascript:void(0)" data-href="{% url 'Humanview_file' %}?ID={{ IdentityInfo.id }}&model=EmployeeIdentityInformationDetails_Pan" 
                                    class="btn btn-primary btn-sm ml-2"
                                    onclick="showEduDetails(this)"
                                    >
                                    <span class="fa fa-eye"></span>
                                    </a>
                                    {% else%}
                                    {% endif %}
                        </div>
                    </div>
                
                    
                    <div class="col-md-4">
                        <div class="form-group">
                        <label>Upload Driving Licence</label>
                        <input type="file" name="DrivingLicenceattachment" id="" class="form-control  mb-3" >
                        {% if IdentityInfo.DrivingFileName %}
                            Previous Document
                            <a  href="javascript:void(0)" data-href="{% url 'Humanview_file' %}?ID={{ IdentityInfo.id }}&model=EmployeeIdentityInformationDetails_License" 
                            class="btn btn-primary btn-sm ml-2"
                            onclick="showEduDetails(this)"
                            >
                            <span class="fa fa-eye"></span>
                            </a>
                        {% else%}
                        {% endif %}
                            <div class="CustomFooter ">
                                <button type="submit" id="saveButton" class="btn btn-primary Successpopup" style="display: none;">Save</button>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const editButton = document.getElementById('editButton');
        const saveButton = document.getElementById('saveButton');
        const inputs = document.querySelectorAll('#IdentityInfoForm input, #IdentityInfoForm select, #IdentityInfoForm textarea');
        
        function toggleInputs(disabled) {
            inputs.forEach(input => {
                if (disabled) {
                    input.setAttribute('readonly', 'readonly');
                    input.setAttribute('disabled', 'disabled');
                } else {
                    input.removeAttribute('readonly');
                    input.removeAttribute('disabled');
                }
            });
        }
    
        editButton.addEventListener('click', function() {
            if (editButton.textContent.trim() === 'Edit') {
                editButton.textContent = 'Cancel';
                saveButton.style.display = 'inline-block';
                toggleInputs(false);
            } else {
                editButton.textContent = 'Edit';
                saveButton.style.display = 'none';
                toggleInputs(true);
            }
        });
    
       
        toggleInputs(true);
    });
    
</script>

<script>
    $(document).ready(function () {
        const urlParams = new URLSearchParams(window.location.search);
        const success = urlParams.get('Success');
        
        if (success === 'True') {
            showSuccess();
            removeSuccessParam();
        }
        if (success === 'Deleted') {
            showDelete();
            removeSuccessParam();
        }
        if (success === 'Uploaded') {
            showUploaded();
            removeSuccessParam();
        }

        function removeSuccessParam() {
            urlParams.delete('Success'); 
            const newUrl = window.location.pathname + '?' + urlParams.toString();
            window.history.replaceState(null, '', newUrl);
        }
    });
</script>

<script>
    var showEduDetails= function(obj)
    {
            var hurl = $(obj).attr('data-href');
            $(".modalPr").modal('show')
            $(".modalPr iframe").attr('src',hurl);

    }
   

</script>


{% endblock content %}





