{% extends "HR/EmployeeDashboard/EditEmployee.html" %}
 {% load static %} 
{% block content %}
<link href="{% static 'css/plugins/sweetalert/sweetalert.css' %}" rel="stylesheet">

<style>
    
    #ProfileImagePreview {
        border-radius: 50%;
        border: 2px solid #ddd;     
        margin-top: 10px;
        max-width: 150px; 
        height: 150px;    
        object-fit: cover; 
    }

    .Name
    {
        width: 200px;
    }

    .Date
    {
        width: 140px;
    }

    .Designation
    {
        width: 150px;
    }

    .Department
    {
        width: 150px;
    }
    .EmpCode
    {
        width: 80px;
    }
    .Signed
    {
        width: 250px;
    }
    .Action 
    {
        width : 160px
    }
    .Status{
        width : 120px
    }
    .HRHODIT
    {
        width : 140px
    }
    .IT{
        width:160px
    }

    .card {
        border-radius: 5px;
        border: 1px solid #0000004f;
    }

    .card-header{
        margin-bottom: -20px !important;
    }
</style>


<div class="card">
    <div class="card-header">
       <span class=" text-uppercase fw-bold">  IT Request </span> 
    
        {% if not ITS %}
        <a href="{% url 'HrRequest' %}?EC={{EC}}&EmpID={{EmpID}}&OID={{OrganizationID}}" class="btn btn-sm btn-primary" style="float:right">New IT Request</a>
        {% endif %}        
    </div>

    <div class="m-3">
        <div style="max-height: 350px; overflow-y: auto; overflow-x: auto;">
            <table class="table table-bordered table-condensed  display table-sm compact" style="font-size:11px">
                <thead>
                    <tr class="active" style="background-color:#8e9ebc">
                        <th class="EmpCode">Code</th>
                        <th class="Name">Name</th>

                        <th class="Designation">Desi / Dept</th>
                        {% comment %} <th class="Department">Department</th> {% endcomment %}
                        <th>HR</th>
                        <th>HOD</th>

                        <th>IT</th>
                        <th class="Status" >Sim</th>
                        <th class="Status" >Mobile</th>
                        <th class="Status" >Email</th>
                        <th class="Status" >System</th>
                        <th class="Action">Action</th>
                    </tr>

                </thead>
                
                    
                    <tbody>
                        {% for item in ITS %}
                        <tr>
                            <td>{{ item.it.EmployeeCode }}</td>
                            <td>{{ item.it.EmployeeName }}</td>
                            <td>{{ item.it.DesignationGrade }} <br/>{{ item.it.Department }}</td>
                            {% comment %} <td>{{ item.it.Department }}</td> {% endcomment %}
                            <td>
                                {% if item.it.HrStatus == "1" %}Submitted{% endif %}
                                
                        </td>
                        <td>
                            {% if item.it.HodStatus == "0" %}Pending{% endif %}
                            {% if item.it.HodStatus == "1" %}Approved{% endif %}
                            {% if item.it.HodStatus == "-1" %}Rejected{% endif %}

    
                        </td>

                        <td>
                            {% if item.it.ItStatus == "0" %}PendingIT{% endif %}
                            {% if item.it.ItStatus == "1" %}Approved{% endif %}
                            {% if item.it.ItStatus == "-1" %}Rejected{% endif %}
                        </td>
    
                            <td>{{ item.sim_issued }}</td>
                            <td>{{ item.mobile_issued }}</td>
                            <td>{{ item.email_issued }}</td>
                            <td>{{ item.system_issued }}</td>
                            <td>
                            {% if item.it.HodStatus == "1"   %}
                            
                            <a href="{% url 'HrRequest' %}?EC={{EC}}&EmpID={{EmpID}}&ITID={{item.it.id}}&OID={{OrganizationID}}" class="btn btn-primary btn sm">Edit</a>
                            
                                
                            {% comment %} <a href="{% url 'DeleteIT'%}ID={{item.it.id}}" onclick="return confirm('Are you sure you want to delete this?')"><i class="fa fa-trash text-danger"></i></a> {% endcomment %}
                            {% endif %}
                            
                            
                            
                            </td>
                        </tr>
                        {% endfor %}
                    
                </tbody>

            </table>
    </div>
</div>
    
   
<script>
    $(document).ready(function () {
        const urlParams = new URLSearchParams(window.location.search);
        const success = urlParams.get('Success');
        
        if (success === 'True') {
            showSuccess();
            removeSuccessParam();
        }
        if (success === 'Deleted') {
            showDelete();
            removeSuccessParam();
        }
        if (success === 'Uploaded') {
            showUploaded();
            removeSuccessParam();
        }

        function removeSuccessParam() {
            urlParams.delete('Success'); 
            const newUrl = window.location.pathname + '?' + urlParams.toString();
            window.history.replaceState(null, '', newUrl);
        }
    });
</script>



{% endblock content %}





