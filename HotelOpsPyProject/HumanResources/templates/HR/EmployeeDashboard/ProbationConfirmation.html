{% extends "HR/EmployeeDashboard/EditEmployee.html" %}
 {% load static %} 
{% block content %}
<link href="{% static 'css/plugins/sweetalert/sweetalert.css' %}" rel="stylesheet">

<style>
    
    #ProfileImagePreview {
        border-radius: 50%;
        border: 2px solid #ddd;     
        margin-top: 10px;
        max-width: 150px; 
        height: 150px;    
        object-fit: cover; 
    }

    .card {
        border-radius: 5px;
        border: 1px solid #0000004f;
    }

    .card-header{
        margin-bottom: -20px !important;
    }
    
    .card .card-body {
        padding: 18px !important;
    }


    .btn-primary{
        border-radius:5px !important;
    }
</style>


<div class="card">
    <div class="card-header">
       <span class=" text-uppercase fw-bold">  Probation Confirmation </span> 
            {% if Emp_objshow  == 'Show'  %}
            
            <a href="{% url 'NewPC' %}?EC={{EC}}&EmpID={{EmpID}}&OID={{OrganizationID}}" class="btn btn-sm btn-primary" style="float:right">New Probation Confirmation</a>
            {% endif %}
            
        </div>
        <div class="card-body">
                <table class="table table-bordered table-condensed  display table-sm compact" style="font-size:11px">
                    <thead>
                        <tr class="active" style="background-color:#8e9ebc">
                            <th class="EmpCode" >Code</th>
                            <th class="Name">Name</th>
    
                            <th class="Designation">Desi / Dept</th>
                            {% comment %} <th class="Department">Department</th> {% endcomment %}
                            {% comment %} <th class="Date">Joining Date</th> {% endcomment %}

                            <th class="Date">Confi. Date</th>
                           
                            <th class="">Confirmed</th>
    
                            <th class="Action" width="100">Probation Letter</th>
                            <th class="Action" width="230">Signed Document</th>
                            <th class="Action" width="150">Action</th>
                           

                        </tr>
    
                    </thead>
                    <tbody>
                        {% for Emp_obj in Emp_objs %}
                        <tr>
                            <td>{{Emp_obj.EmpCode}}</td>
                            <td>{{Emp_obj.EmpName}}</td>
                            <td>{{Emp_obj.Department}} <br/>{{Emp_obj.Position}}</td>
                            {% comment %} <td>{{Emp_obj.Position}}</td> {% endcomment %}
                            {% comment %} <td>{{Emp_obj.JoiningDate|date:'d-m-Y'}}</td> {% endcomment %}
                            <td>{{Emp_obj.ConfDate |date:'d-m-Y'}}</td>
                            <td>
                                {% if Emp_obj.EmpConfirm  == True %}Yes{% else %}No  {% if Emp_obj.Extended %}- {{Emp_obj.Extended}}{% endif %}  {% endif %}


                            </td>
                            <td>

                                <div class="btn-group gap-2">
                                    <a href="{% url 'NewPC' %}?ID={{Emp_obj.id}}&EC={{EC}}&EmpID={{EmpID}}&OID={{OrganizationID}}"  title="Edit Entry" class="btn btn-primary btn-sm">Edit</a>
                                    
                                    {% if UserID  == '20201212178780' or UserID  == '20201212175519' %}
                                    <a href="{% url 'DeletePC' %}?ID={{Emp_obj.id}}&EC={{EC}}&EmpID={{EmpID}}&OID={{OrganizationID}}" onclick="return confirm('Are you sure you want to delete this?')" class="btn btn-danger text-white btn-sm"><i class="fa fa-trash"></i></a>
                                    {% endif %}
                                    
                                    <a href="{% url 'ViewPC' %}?ID={{Emp_obj.id}}&EC={{EC}}&EmpID={{EmpID}}&OID={{OrganizationID}}"  title="View Entry" class="btn btn-primary btn-sm" target="_blank">View</a>
                                </div>
                                
                              
                              
                        </td>
                        <td>
                                  
                            <span style="position: relative; ">
                                {% if  Emp_obj.EmpConfirm  == True  and Emp_obj.LOC_ID  %}
                                    {% if Emp_obj.Cnf_Filename  %} 
                                    
                                    <a class="btn btn-danger text-white btn-sm"  title="Delete Document" href="{% url "repalce_filecl" %}?EmpID={{EmpID}}&LOC_ID={{Emp_obj.LOC_ID}}&OID={{OrganizationID}}"><i class="fa fa-trash"></i></a>
                                    <a class="btn btn-primary btn-sm"  title="Download Document" href="{% url "download_filecl" %}?LOC_ID={{Emp_obj.LOC_ID}}&OID={{OrganizationID}}"><i class="fa fa-download"></i></a>
                                    
                                    {% elif Emp_obj.LOC_ID %}
                                    <a class="btn btn-secondary btn-sm"  title="Upload Document" href="{% url "upload_filecl" %}?EmpID={{EmpID}}&LOC_ID={{Emp_obj.LOC_ID}}&OID={{OrganizationID}}"><i class="fa fa-upload"></i></a>
                                    {% endif %}
                                {% endif %} 
                            </span> 
                        </td>
                        <td>
                            <div class="btn-group gap-2 mt-1">
                                  
                                {% if Emp_obj.LOC_ID  %} 
                                    <a href="{% url 'entryempcl' %}?ID={{Emp_obj.id}}&EC={{EC}}&EmpID={{EmpID}}&LOC_ID={{Emp_obj.LOC_ID}}&DepartmentName={{ Emobj.Department }}&OID={{OrganizationID}}"   class="btn btn-primary btn-sm">Edit</a>
                                    
                                    <a href="{% url 'generate_Confirmation_Letter' %}?ID={{Emp_obj.id}}&EC={{EC}}&EmpID={{EmpID}}&LOC_ID={{Emp_obj.LOC_ID}}&OID={{OrganizationID}}"   class="btn btn-primary btn-sm" target="_blank">View</a>
                                    <a href="{% url 'generate_Confirmation_Letter' %}?ID={{Emp_obj.id}}&EC={{EC}}&EmpID={{EmpID}}&LOC_ID={{Emp_obj.LOC_ID}}&OID={{OrganizationID}}&head=False"   class="btn btn-secondary text-white btn-sm">Print</a>
                                    
                                {% else %}
                                    {% if  Emp_obj.EmpConfirm  == True %}
                                        <a href="{% url 'entryempcl' %}?ID={{Emp_obj.id}}&EC={{EC}}&EmpID={{EmpID}}&DepartmentName={{ Emobj.Department }}&OID={{OrganizationID}}" class="btn btn-primary btn-sm">Generate  Letter</a>
                                    {% endif %}
                                    
                                {% endif %} 

                            </div>
                            
                        </td>   
                        </tr>
                        {% endfor %}
                    </tbody>
    
                </table>
        </div>
    </div>
    
   

    <script>
        $(document).ready(function () {
            const urlParams = new URLSearchParams(window.location.search);
            const success = urlParams.get('Success');
            
            if (success === 'True') {
                showSuccess();
                removeSuccessParam();
            }
            if (success === 'Deleted') {
                showDelete();
                removeSuccessParam();
            }
            if (success === 'Uploaded') {
                showUploaded();
                removeSuccessParam();
            }
    
            function removeSuccessParam() {
                urlParams.delete('Success'); 
                const newUrl = window.location.pathname + '?' + urlParams.toString();
                window.history.replaceState(null, '', newUrl);
            }
        });
    </script>


{% endblock content %}





