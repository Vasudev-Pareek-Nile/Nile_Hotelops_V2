{% extends 'lettercl/homebase.html' %}
{% load static %}


{% block content %} 

<style>
    table thead th{
        text-transform:uppercase;
        font-size:14px;
    }
    #employeeTable_previous a{
        display: flex !important;
        align-items: center !important;
        height: 38px !important;
        width: 34.5px !important;
        justify-content: center !important;
    }

    #employeeTable_next a{
        display: flex !important;
        align-items: center !important;
        height: 38px !important;
        width: 34.5px !important;
        justify-content: center !important;
    }
</style>

{% if message %}
    {% for message in messages %} 
        {% if message.tags == 'success' %}
            <div class="container text-center mt-3">
                <div class="alert alert-success" role="alert">{{ message|safe }}</div>
        {% else %}
                <div class="alert alert-danger" role="alert">{{ message|safe }}</div>
            </div>
        {% endif %} 
    {% endfor %}
{% endif %}

<div class="card">
    <div class="card-header"><span class="text-uppercase fw-bold">Confirmation Letter List </span></div>

 <div class="card-body">
    <div class="col-md-12">
        <form method="GET" class="row g-2">
            <div class="col-md-3">
                {% comment %} <label for="organizationSelect" class="form-label">Select Organizations</label> {% endcomment %}
                <select name="OID" id="organizationSelect" class="form-control">
                    {% for itm in memOrg %}
                    <option value="{{ itm.OrganizationID }}" {% if itm.OrganizationID == OID %}selected{% endif %}>{{ itm.OrganizationName }}</option>
                    {% endfor %}
                </select>
                    <script>
                        $(document).ready(function () {
                            var selectedOrganization = "{{ OID }}";
                            $("select[name='OID']").val(selectedOrganization);
                            
                        });
                    </script>
            </div>
        
            <div class="col-md-4 d-flex justify-items-start align-items-center gap-2" >
                <button type="submit" class="btn mr-4 btn-primary" id="filter">
                    Filter
                </button>
            
                <a href="{% url 'emplistcl' %}" class="btn btn-danger" id="Clear">
                    Clear
                </a>
            </div>
        </form>  
    </div>

    <table id="employeeTable" class="table table-striped table-bordered datatable dataTable no-footer">
        <thead>
            <tr>
                <th>SR#</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Confirmation  Date</th>
                <th>Appointment  Date</th>
                
                <th>Designation</th>
                <th>Department</th>
                <th  width="150">File Upload</th>
                <th width="200">Actions</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            {% for empdetail in empdetails %}
                <tr>
                    <td>{{forloop.counter}}</td>
                    <td>{{empdetail.first_name}}</td>
                    <td>{{empdetail.last_name}}</td>
                    <td>{{empdetail.date_of_confirmation | date:'d-m-Y'}}</td>
                    <td>{{empdetail.date_of_appointment | date:'d-m-Y'}}</td>

                    <td>{{empdetail.designation}}</td>
                    <td>{{empdetail.department}}</td>

                    <td>
                        {% if empdetail.file_name  %}
                            <div class="d-flex justify-content-center gap-2">
                                <a class="btn btn-danger btn-sm text-white" href="{% url "repalce_filecl" %}?EmpID={{empdetail.EmpID}}&LOC_ID={{empdetail.id}}&OID={{empdetail.OrganizationID}}&Page=emplistcl">Delete</a>
                                <a class="btn btn-primary btn-sm" href="{% url "download_filecl" %}?LOC_ID={{empdetail.id}}&OID={{empdetail.OrganizationID}}">Download</a>
                            </div>
                        {% else %}
                            <a class="btn btn-primary btn-sm" href="{% url "upload_filecl" %}?EmpID={{empdetail.EmpID}}&LOC_ID={{empdetail.id}}&OID={{empdetail.OrganizationID}}&Page=emplistcl">Upload File</a>
                        {% endif %} 
                    </td>
                    
                    <td>
                        <a href="{% url 'entryempcl' %}?ID={{empdetail.id}}&EC={{empdetail.emp_code}}&EmpID={{empdetail.EmpID}}&LOC_ID={{empdetail.id}}&DepartmentName={{ empdetail.department }}&Page=emplistcl&OID={{empdetail.OrganizationID}}"   class="btn btn-primary btn-sm">Edit</a>
                        <a 
                            href="#" 
                            onclick="showview(this)" 
                            data-href="{% url 'generate_Confirmation_Letter' %}?ID={{empdetail.id}}&EC={{EC}}&EmpID={{empdetail.EmpID}}&LOC_ID={{empdetail.id}}" 
                            class="btn btn-primary btn-sm">
                            View
                        </a>

                        <a href="{% url 'generate_Confirmation_Letter' %}?ID={{empdetail.id}}&EC={{EC}}&EmpID={{empdetail.EmpID}}&LOC_ID={{empdetail.id}}&head=False"   target="_blank"  class="btn btn-primary btn-sm">Print </a>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
</div>





{% endblock content %}
