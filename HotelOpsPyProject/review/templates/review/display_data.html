<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <style>
        body{
            background-color: rgb(248,248,248);
        }
        .box {
            /* background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden; */
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            width: 100%;
        }

        .box h5 {
            padding: 0;
            font-size: 2rem;
            color: #333;
            TEXT-ALIGN: LEFT;
        }

        .box p {
            padding: 0;
            margin: 0;
            TEXT-ALIGN: LEFT;
            FONT-SIZE: SMALL;

        }

        .box .arrow-icon {
            position: absolute;
            right: 0PX;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
            color: #ffffff;
            padding-right: 10px;
            z-index: 1;
            background: #0e77c5;
            height: 100%;
            WIDTH: 30PX;
            PADDING-TOP: 33PX;
            PADDING-LEFT: 6PX;
        }

        .col-md-2 {
            /* flex: 0 0 auto;
        width: 16.66666667%; */
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;

        }

        .heading {
            font-size: 1rem;
            /* Adjust as needed */
            margin-bottom: 10px;
            /* Space between heading and circle */
        }

        .progress-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: conic-gradient(rgb(3,136,163) calc(var(--value) * 1%), #e9ecef 0);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.25rem;
            position: relative;
            margin: auto;
        }

        .progress-circle::before {
            content: '';
            position: absolute;
            width: 80%;
            height: 80%;
            background-color: white;
            border-radius: 50%;
        }

        .progress-circle span {
            z-index: 1;
        }

        .tr {
            background-color: rgb(81, 195, 206);

            .arrow-icon {
                background-color: rgb(73, 175, 185)
            }
        }

        .response {
            background-color: rgb(113, 133, 202);

            .arrow-icon {
                background-color: rgb(102, 119, 181)
            }


        }

        .neutral {
            background-color: rgb(247, 167, 98);

            .arrow-icon {
                background-color: rgb(222, 150, 88)
            }

        }

        .positive {
            background-color: rgb(69, 175, 150);

            .arrow-icon {
                background-color: rgb(62, 157, 135)
            }

        }

        .negative {
            background-color: rgb(183, 77, 77);

            .arrow-icon {
                background-color: rgb(164, 69, 69)
            }

        }

        h4 {
            color: rgb(240, 153, 53) !important;
        }

        .container {
            border: 2px solid #ddd;
            border-radius: 5px;
            padding: 5PX;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .reviw_reply {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .review {
            margin-left: 10px;
            padding: 10px;
        }

        .source {
            text-align: end;
            margin-right: 5px;
        }

        .partner_reviews {
            border: 1px solid #e3e3e3;
            padding: 5px;
        }
        .partner_reviews div:last-child{

            text-align: right;
        }
        .partner_reviews div:last-child span{
       background-color: #63e779;color: #ffffff;padding: 5px;
}
        .underline {
    position: relative;
    padding-top: 10px; /* Space between the line and the text */
    margin: 0; /* Remove default margin */
}

.underline::before,
.underline::after {
    content: "";
    display: block;
    position: absolute;
    top: 0; /* Line at the top of the element */
    height: 4px; /* Line thickness */
    border-radius: 4px;
    transition: width 0.3s ease; /* Smooth transition */
}

.underline::before {
    background-color: rgb(1,136,163); /* Line color for the filled percentage */
    width: var(--underline-width, 0%); /* Width based on percentage */
}

.underline::after {
    background-color: rgb(236,236,236); /* Line color for the remaining part */
    left: var(--underline-width, 0%); /* Starts where the filled part ends */
    width: calc(100% - var(--underline-width, 0%)); /* Remaining width */
}
        .col-md-4 {
    width: 100%;
    max-width: 33.33%;
    box-sizing: border-box;
    
}

/* Mood container styling */
.mood-container {
    text-align: center;
    position: relative;
}

/* Styling for mood header */
.mood-header {
    font-size: 1em;

   
    display: inline-block;
    padding-bottom: 5px;
}

/* Styling for mood emoji */
.mood-emoji {
    font-size: 2em;
}
.reviews-container {
    height: 200px; /* Set a fixed height or use max-height if preferred */
    overflow-y: auto; /* Adds a vertical scrollbar if content exceeds the height */
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 10px;
    background-color: #fff; /* Optional background color */
}

.review {
    margin-bottom: 10px; /* Space between reviews */
    padding: 10px;
    border-bottom: 1px solid #eee; /* Optional: border between reviews */
}

.source {
    text-align: end;
    margin-right: 5px;
}

.review-reply {
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.review-text {
    margin-bottom: 10px; /* Space below review text */
}
.review_date{
    text-align: end;
    margin-right: 5px;
    font-size: 14px;
    font-weight: 100;

}
.search-button{
    display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 70px;
            height: 30px;
            background-color:rgb(91, 175, 231);
            border: none;
            margin-top: 24px;
    margin-left: 5px;
    border-radius: 5px;
}
.partner_rating{

    font-weight: 500;
}


.underline {
    position: relative;
    padding-top: 5px; /* Space between the line and the text */
    margin: 0; /* Remove default margin */
}

.underline::before {
    content: "";
    display: block;
    position: absolute;
    top: 0; /* Line at the top of the element */
    left: 0;
    width: var(--underline-width, 0%); /* Use the CSS variable for width */
    height: 4px; /* Line thickness */
    border-radius: 4px;
    background-color: rgb(1,136,163); /* Line color */
    transition: width 0.3s ease; /* Smooth transition */
}

.container.mt-4 {
    box-shadow: 0px 0px 0px 1px #dedede;
    border: 0px;
    padding: 8px;
}

.ttc {
    display: flex;
}
.ttc div{
        flex:1;
    margin:5px;
}
.ttc *{
    color:#fff !important;
}
    </style>
</head>

<body>
    {% include 'review/navbar.html' %}

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <form method="get" class="d-flex" role="search" style="margin-left: 60px;" action="{% url 'selectOrganization' %}">
                {% csrf_token %}
                <div class="form-group">
                    <label for="organization-select">Organization:</label>
                    <select id="organization-select" name="OrganizationID" class="form-select">
                        <option value="">Select an option</option>
                        {% for org_id, org_label in organization_choices %}
                        <option value="{{ org_id }}" {% if org_id == selected_org_id %}selected{% endif %}>
                            {{ org_label }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                



                <button class="search-button" type="submit">Search</button>
                
            </form>
            <a class="btn btn-outline-primary ms-2" href="#download" role="button">
                <i class="fas fa-download"></i> Download
            </a>
        </div>
    </nav>


    <div class="container mt-4">
        <h4>Dashboard</h4>
        <div class="ttc">
            <div >
                
                <div class="box tr">
                    <h5>{{total_dict.total_review |default:"0"}}</h5>
                    <p>Total review</p>
                    <a href="{% url 'feedback' %}"><i class="fas fa-long-arrow-right arrow-icon"></i></a>
                </div>
            </div>
            <div >
                <div class="box response">
                    <h5>{{total_dict.total_response |default:"0"}}</h5>
                    <p>Total responded</p>
                    <a href="{% url 'feedback' %}"><i class="fas fa-long-arrow-right arrow-icon"></i></a>
                    
                </div>
            </div>
            <div >
                <div class="box negative">
                    <h5>{{classification_counts.Negative |default:"0"}}</h5>
                    <p>Total negative</p>
                    <a href="{% url 'feedback' %}?sentiment=Negative"><i class="fas fa-long-arrow-right arrow-icon"></i></a>
                    
                </div>
            </div>
            <div >
                <div class="box positive">
                    <h5>{{classification_counts.Positive |default:"0"}}</h5>
                    <p>Total positive</p>
                    <a href="{% url 'feedback' %}?sentiment=Positive"><i class="fas fa-long-arrow-right arrow-icon"></i></a>
                    
                </div>
            </div>
            <div >
                <div class="box neutral">
                    <h5>{{ classification_counts.Neutral |default:"0"}}</h5>
                    <p>Total Neutral</p>
                    <a href="{% url 'feedback'%}?sentiment=Neutral"><i class="fas fa-long-arrow-right arrow-icon"></i></a>
                </div>
            </div>
        </div>
    </div>


    {% if averages %}
    <div class="container mt-4">
        <h4>Overall Status</h4>
        <div class="row">
            <div class="col-md-2 mb-2">
                <h7>Hotel rating</h7>
                <div class="progress-circle" style="--value: {{ averages.avg_hotel}}*20">
                    <span>{{ averages.avg_hotel}}</span>
                </div>
            </div>
            <div class="col-md-2 mb-2">
                <h7>Cleanliness</h7>
                <div class="progress-circle" style="--value: {{averages.avg_cleanliness}}*20;">
                    <span>{{averages.avg_cleanliness |default:"0"}}</span>
                </div>
            </div>
            <div class="col-md-2 mb-2">
                <h7>Staff and Service</h7>
                <div class="progress-circle" style="--value: {{averages.avg_service}}*20;">
                    <span>{{averages.avg_service |default:"0"}}</span>
                </div>
            </div>
            <div class="col-md-2 mb-2">
                <h7>Room comfort</h7>
                <div class="progress-circle" style="--value: {{averages.avg_room}}*20;">
                    <span>{{averages.avg_room |default:"0"}}</span>
                </div>
            </div>
            <div class="col-md-2 mb-2">
                <h7>Location</h7>
                <div class="progress-circle" style="--value: {{averages.avg_location}}*20;">
                    <span>{{ averages.avg_location |default:"0"}}</span>
                </div>
            </div>
            <div class="col-md-2 mb-2">
                <h7>Value</h7>
                <div class="progress-circle" style="--value: {{averages.avg_value}}*20;">
                    <span>{{averages.avg_value |default:"0"}}</span>
                </div>
            </div>
        </div>
        
    </div>
    {% endif %}


    <div class="container mt-4">
        <div class="row">
            <div class="col-md-8 mr-2">
                <h4>Recent Reviews</h4>
                <div class="reviews-container">
                    {% for review in reviewslist %}
                        <div class="review">
                            <div class="source">{{ review.source }}</div>
                            <div class="review-text mt-4">
                                {{ review.review_text }}
                            </div>
                            <div class="review-reply">
                                <h5>Reply:</h5>
                                {{ review.management_response|default:"No response" }}
                                <p class="review_date">Replied on: {{ review.reply_date }}</p>
                            </div>
                        </div>
                    {% empty %}
                        <p>No reviews available.</p>
                    {% endfor %}
                </div>
            </div>
    
            <div class="col-md-3" style="margin-left:50px">
                <h4>Partner Reviews</h4>
                <div class="row partner_reviews">
                    <div class="col-md-9">Google:</div>
                    <div class="col-md-3"><span>{{source_counts.Google}}</span></div>
                </div>
                <div class="row partner_reviews">
                    <div class="col-md-9">TripAdvisor:</div>
                    <div class="col-md-3"> <span> {{ source_counts.Tripadvisor|default:"0" }}</span></div>
                </div>
                <div class="row partner_reviews">
                    <div class="col-md-9">Booking.com:</div>
                    <div class="col-md-3"><span>{{source_counts.Booking.com|default:"0" }} </span>
                    </div>
                </div>
                <div class="row partner_reviews">
                    <div class="col-md-9">Agoda:</div>
                    <div class="col-md-3"> <span>{{source_counts.Agoda|default:"0" }} </span>
                    </div>
                </div>
                <div class="row partner_reviews">
                    <div class="col-md-9">MakeMyTrip:</div>
                    <div class="col-md-3"><span>{{source_counts.MakeMyTrip|default:"0"}} </span>

                    </div>
                </div>
                
            </div>

        </div>




    </div>

    <div class="container mt-4">
        <h4>Partner rating</h4>
    <div class="row">

    {% for partner, ratings in data.items %}
        <div class="col-md-6 mr-2 mt-4">
            <div class="row">
                <div class="col-md-2">
                    <h5 class="partner_rating">{{ partner }}</h5>
                    <div class="progress-circle" style="--value: {{ratings.Overall_Rating |default:0}}*20;">
                        <span>{{ ratings.Overall_Rating |default:"0"  }}/5</span>
                    </div>
                </div>
                <div class="col-md-9 ms-4">
                    <div class="row">
                        <div class="col-md-6">
                            <p class="underline" data-percentage="{{ ratings.Cleanliness|default:0 }}">Cleanliness</p>
                        </div>
                        <div class="col-md-6">
                            <p class="underline" data-percentage="{{ ratings.Room|default:0  }}">Room Comfort</p>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <p class="underline" data-percentage="{{ ratings.Location|default:0 }}">Location</p>
                        </div>
                        <div class="col-md-6">
                            <p class="underline" data-percentage="{{ ratings.Facilities|default:0 }}">Facilities</p>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <p class="underline" data-percentage="{{ ratings.Service|default:0 }}">Customers Service</p>
                        </div>
                        <div class="col-md-6">
                            <p class="underline" data-percentage="{{ ratings.Value|default:0}}">Value for Money</p>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-6">
                            <p class="underline" data-percentage="{{ratings.Food|default:0}}">Food</p>
                        </div>
                        <div class="col-md-6">
                            <p class="underline" data-percentage="ratings.Wifi|default:0">Wifi(Free)</p>
                        </div>
                    </div>
                </div>
            </div>
            <hr>
        </div>
    {% endfor %}
    </div>

       
     </div>


    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
    var underlines = document.querySelectorAll('.underline');

    underlines.forEach(function(element) {
        var percentage = element.getAttribute('data-percentage');
        percentage=percentage*10;

        element.style.setProperty('--underline-width', percentage + '%');
    });
});


</script>
</body>

</html>