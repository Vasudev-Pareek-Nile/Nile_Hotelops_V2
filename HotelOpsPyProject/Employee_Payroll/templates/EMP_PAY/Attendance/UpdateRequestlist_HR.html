{% extends "EMP_PAY\homebase.html" %}
{% block content %}


{% if messages %}
    <div class="cotainer mt-2 mb-2">
        <div class="container text-center">
            {% for message in messages %} {% if message.tags == 'success' %}
            <div class="alert alert-success" role="alert">{{ message|safe }}</div>
            {% else %}
            <div class="alert alert-danger" role="alert">{{ message|safe }}</div>
            {% endif %} {% endfor %}
        </div>
    </div>
{% endif %}  

<style>
    .card .card-body, .card .card-header {
        padding: 15px;
    }
    .card{
        position: relative;
    }
    .card .card-body{
        padding-top: 0px;
    }

    .page-wrapper .content {
        padding: 0px !important;
    }
</style>

<div class="card">
    <div class="card-header">
        <div class="d-flex justify-content-between align-items-center mb-2">
            <div class="text-uppercase fw-bold ">Request List</div>   
            <div class="">
                {% include "EMP_PAY/Attendance/AttendanceNavbar.html" %} 
            </div>    
        </div>    
        <form method="get" class="d-flex">
            <div class="col-md-12">
                <div class="row">
                    <div class="col-md-3"> 
                        <select name="Status" id="" class="form-control">
                            <option value="1" {% if Status == selectedStatus %}selected{% endif %}>Approved</option>
                            <option value="0" {% if Status == selectedStatus %}selected{% endif %}>Pending</option>
                            <option value="-1" {% if Status == selectedStatus %}selected{% endif %}>Rejected</option>
                        </select>
                    </div>
                    <div class="col-md-9">
                        <button type="submit" class="btn mr-4 btn-primary" style="padding-inline:15px; padding-block:8px;">Filter</button>
                    
                        <a href="{% url 'UpdateRequestlist_HR' %}" class="btn btn-danger ml-3" style="padding-inline:15px; padding-block:8px;">
                            Clear
                        </a>
                    </div>
                </div>
            </div>  
        </form>
    </div>  

    <div class="card-body">

    <div class="row">
        <div class="col-md-12"> 
            <table id="example" class="table table-striped custom-table mb-0 datatable dataTable no-footer">
                <thead>
                    <tr>
                        <th>Employee Name</th>
                        <th>Date</th>
                        <th>In Time</th>
                        <th>Out Time</th>
                        <th>Status</th>
                        <th>Reason</th>
                        <th>Approval</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for reqs in att_reqs %}
                        {% for employee in employee_data %}
                            {% if reqs.Attendance_Data.EmployeeCode == employee.EmployeeCode %}
                                <tr>
                                    <td>{{employee.EmpName}}</td>
                                    <td>{{reqs.Attendance_Data.Date}}</td>
                                    <td>{{reqs.Attendance_Data.In_Time}}</td>
                                    <td>{{reqs.Attendance_Data.Out_Time}}</td>
                                    <td>{{reqs.Attendance_Data.Status}}</td>
                                    <td>{{reqs.Reason}}.</td>
                                    <td>
                                        {% if reqs.Apporve_status == "0" %}
                                            <span class="btn btn-warning btn-sm">Pending</span>
                                        {% elif reqs.Apporve_status == "1" %}
                                            <span class="btn btn-primary btn-sm">Approved</span>
                                        {% else %}
                                            <span class="btn btn-danger btn-sm">Reject</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        <a href="{% url 'Update_Attendance' %}?ID={{reqs.Attendance_Data.id}}&U_ID={{reqs.id}}" class="btn btn-primary btn-sm">EDIT</a>
                                    </td>
                                </tr>
                            {% endif %}
                        {% endfor %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
       
       var selectedStatus = "{{ Apporve_status }}";
       $("select[name='Status']").val(selectedStatus);
   });
</script>
{% endblock content %}
