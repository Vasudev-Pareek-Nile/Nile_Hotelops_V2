{% extends 'letterpl/homebase.html' %}
{% load static %}


{% block content %} 

<style>
    table thead th{
        text-transform:uppercase;
        font-size:14px;
    }
	#clear, #filter{
		padding-block: 8px;
	}
    #employeeTable_previous a{
        display: flex !important;
        align-items: center !important;
        height: 38px !important;
        width: 34.5px !important;
        justify-content: center !important;
    }

    #employeeTable_next a{
        display: flex !important;
        align-items: center !important;
        height: 38px !important;
        width: 34.5px !important;
        justify-content: center !important;
    }
</style>


<div class="card">
    <div class="card-header">
        <div class="row">
            <div class="col-md-6"><span class="text-uppercase fw-bold">Letter of Promotion</span></div>
        </div>
    </div>
    <!-- <br> -->
    <div class="card-body">
            <div class="col-md-12">
                <form method="GET" class="row g-4">
                    <div class="col-md-5">
                        <select name="I" id="organizationSelect" class="form-control ">
                            {% for itm in memOrg %}
                            <option value="{{ itm.OrganizationID }}">{{ itm.OrganizationName }}</option>
                            {% endfor %}
                        </select>
                    </div>
                
                    <div class="col-md-4 d-flex justify-items-start align-items-center gap-2" >
                        <button type="submit" class="btn btn-primary" id="filter">
                            Filter
                        </button>
                    
                        <a href="{% url 'emplistpl' %}" class="btn btn-danger" id="clear">
                            Clear
                        </a>
                    </div>
                </form>  
            </div>


            <table id="employeeTable" class="table table-striped table-bordered datatable dataTable no-footer">
                <thead>
                    <tr class="active" style="background-color:#8e9ebc">
                        <th class="EmpCode">SR#</th>
                        <th class="EmpCode">Code</th>
                        <th class="Name">Name</th>
                        <th class="Designation">Designation</th>
                        <th class="Department">Department</th>
                        <th class="Date">Date of Promotion</th>
                        <th class="Signed" style="width:  204px;">Signed Document</th>
                        <th class="Action" style="width:  181px;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for PromotionLetter in PromotionLetters %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ PromotionLetter.emp_code }}</td>
                        <td>{{ PromotionLetter.first_name }} {{ PromotionLetter.last_name }}</td>
                        <td>{{ PromotionLetter.designation }}</td>
                        <td>{{ PromotionLetter.department }}</td>
                        <td>{{PromotionLetter.date_of_promtion|date:'d-m-Y'}}</td>  
                        
                        <td>
                            {% if PromotionLetter.file_name %}
                                <div class="d-flex justify-content-be gap-2">
                                    <a class="btn btn-danger btn-sm text-white" href="{% url 'repalce_filepl' %}?EmpID={{ PromotionLetter.EmpID }}&LOP_ID={{ PromotionLetter.id }}&Page=emplistpl&OID={{PromotionLetter.OrganizationID}}">Delete</a>
                                    <a class="btn btn-primary btn-sm" href="{% url 'download_filepl' %}?LOP_ID={{ PromotionLetter.id }}">Download</a>
                                </div>
                            {% else %}
                                <a class="btn btn-primary btn-sm" href="{% url 'upload_filepl' %}?EmpID={{ PromotionLetter.EmpID }}&LOP_ID={{ PromotionLetter.id }}&Page=emplistpl&OID={{PromotionLetter.OrganizationID}}">Upload File</a>
                            {% endif %}
                        </td>
                        <td>
                            <span style="position: relative;">
                                {% if PromotionLetter.id == PromotionLetter.last_Promotion_id %}
                                    <a class="btn btn-primary btn-sm" href="{% url 'entryemppl' %}?EC={{ PromotionLetter.emp_code }}&EmpID={{ PromotionLetter.EmpID }}&LOP_ID={{ PromotionLetter.id }}&DepartmentName={{PromotionLetter.department}}&Page=emplistpl&OID={{PromotionLetter.OrganizationID}}">Edit</a>
                                {% endif %}
                                <a class="btn btn-primary btn-sm" href="{% url 'generate_Letter_of_promotion' %}?LOP_ID={{ PromotionLetter.id }}&EmpID={{ PromotionLetter.EmpID }}&OID={{PromotionLetter.OrganizationID}}" target="_blank">View</a>
                                   
                                <a class="btn btn-primary btn-sm" href="{% url "generate_Letter_of_promotion" %}?LOP_ID={{PromotionLetter.id}}&EmpID={{PromotionLetter.EmpID}}&DepartmentName={{ Emobj.Department }}&OID={{PromotionLetter.OrganizationID}}&head=False" target="_blank">Print</a>
                                   
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
        </div>
    </div>


  





<script>
    $(document).ready(function() {
        var selectedOrganization = "{{ I }}";
        $("select[name='I']").val(selectedOrganization);  
    });
    
    
</script>
    

{% endblock content %}

